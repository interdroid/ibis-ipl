JAVACLASSPATH=$CLASSPATH:$IBIS_ROOT/build:

# Ibis Hub controller
# if [ "x$IBIS_HUB" != "x" ]; then
#   # decode Ibis control hub reference
#   HUB_HOST=`echo $IBIS_HUB|cut -f 1 -d :`
#   HUB_PORT=`echo $IBIS_HUB|cut -f 2 -d :`
#   echo "Name service will connect to Ibis hub:"
#   echo "  ${HUB_HOST}:${HUB_PORT}"
#   Dhub="-Dibis.connect.enable -Dibis.connect.control_links=RoutedMessages -Dibis.connect.data_links=PlainTCP -Dibis.connect.hub_host=$HUB_HOST -Dibis.connect.hub_port=$HUB_PORT"
# else
#   Dhub=
# fi
# No IBIS_HUB anymore: controlhub is now integrated within the nameserver,
# with the -controlhub flag.

Dhub=

for i in $*
do
    case $i in
    -controlhub)
	# Note: ibis.connect.data_links must be set or ibis.connect does not
	# work. However, the nameserver only uses control_links, so the
	# contents for data_links does not really matter, as long as the
	# socket type exists.
	Dhub="-Dibis.connect.enable -Dibis.connect.control_links=RoutedMessages -Dibis.connect.data_links=PlainTCP -Dibis.name_server.host=`hostname -f`"
	;;
    esac
done

$JAVA_ROOT/bin/java -classpath $JAVACLASSPATH $Dhub ibis.impl.nameServer.tcp.NameServer "$@"
