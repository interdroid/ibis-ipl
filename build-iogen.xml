    <!--
    Ibis iogen target.

    Require prior definition of properties:
    default.classpath refid of classpath
    build             the root of the build tree, which contains all class files
    -->

    <target name="property-iogen-build" unless="build">
	<echo message="build is undefined. Set it to the default value"/>
	<property name="build" location="build"/>
	<mkdir dir="${build}"/>
    </target>

    <target name="iogen-init"
	    depends="property-iogen-build"/>

    <target name="iogen"
	depends="iogen-init">
	<!-- <echo message="Do ONLY the class files in ibis/ipl"/> -->
	<path id="all-classes">
	    <fileset dir="${build}">
		<include name="**/*.class"/>
		<include name="ibis/ipl/*.class"/>
	    </fileset>
	</path>
	<pathconvert pathsep=" " property="classes.all" refid="all-classes">
	    <map from="${build}" to=""/>
	    <map from="\${file.separator}" to=""/>
	</pathconvert>
	<echo message="All files to be rewritten: ${classes.all}"/>
	<echo message="Run IOGenerator over all classes under ${build}${file.separator}"/>
	<java   classname="ibis.frontend.io.IOGenerator"
		taskname="IOGenerator"
		dir="${build}"
		fork="true">
	    <arg line="-dir ${classes.all}"/>
	    <classpath refid="default.classpath"/>
	</java>
    </target>
