<project
    name="satin"
    default="satin"
    basedir=".">

    <description>
	Ibis satin target.

	Require prior definition of properties:
	default.classpath refid of classpath
	build             the root of the build tree, which contains all class files
    </description>

    <import file="${ibis}/build-properties.xml"/>

    <target name="property-satin-build" unless="build">
	<echo message="build is undefined. Set it to the default value"/>
	<property name="build" location="build"/>
	<mkdir dir="${build}"/>
    </target>

    <target name="satin-init"
	    depends="property-satin-build,property-init"/>

    <target name="satin"
	    depends="satin-init"
	    description="satin all classes that implement java.io.Serializable">
	<if>
	    <isset property="satinc-flags"/>
	    <then>
		<property name="satinc-flags.value" value="${satinc-flags}"/>
	    </then>
	    <else>
		<property name="satinc-flags.value" value=""/>
	    </else>
	</if>

	<property name="satin-class-path" refid="default.classpath"/>

	<java	classname="ibis.frontend.satin.Satinc"
		taskname="Satinc"
		dir="${build}"
		failonerror="true"
		fork="true">
		<arg line="-compiler '${JAVA_HOME}/bin/javac -g -classpath ${satin-class-path}${path.separator}' ${satinc-flags.value} ${satin-main-class}"/>
		<classpath refid="default.classpath"/>
	</java>

    </target>

</project>
